<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico" />

    <title>Navbar Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="../static/css/bootstrap.css" rel="stylesheet" th:href="@{/css/bootstrap.css}" />
    <link href="../static/css/base.css" rel="stylesheet" th:href="@{/css/base.css}" />
    <link href="../static/css/cvss.css" rel="stylesheet" th:href="@{/css/cvssView.css}" />
    <script src="../static/js/jquery.min.js" th:src="@{/js/jquery.min.js}"></script>
</head>

<body>
	<div th:replace="/fragments/navFragment :: nav" th:remove="tag"></div>
    <div class="container mt-lg-2">
        <div class="row w-100">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">IDVN</a></li>
                    <li class="breadcrumb-item active" aria-current="page" th:text="${laporan.code}"></li>
                </ol>
            </nav>
        </div>
        <div class="row border">
            <div class="col-md-12">
                <h4 style="margin-top: 10px;" th:text="${laporan.code}"></h4>
                <h5 style="margin-bottom: 30px;" th:text="${judul}"></h5>
            </div>
            <div class="col">
                <!-- Content Isi -->
                <div class="media text-muted pt-3">
                    <p class="media-body pb-3 mb-0 lh-125 border-bottom text-dark">
                        <strong class="d-block text-gray-dark">Overview</strong>
                        <p th:text="${laporan.overview}" th:remove="tag"></p>
                    </p>
                </div>
                <div class="media text-muted pt-3">
                    <p class="media-body pb-3 mb-0 lh-125 border-bottom text-dark">
                        <strong class="d-block text-gray-dark">Products Affected</strong>
                        <p th:text="${laporan.productAffected}" th:remove="tag"></p>
                    </p>
                </div>
                <div class="media text-muted pt-3">
                    <p class="media-body pb-3 mb-0 lh-125 border-bottom text-dark">
                        <strong class="d-block text-gray-dark">Impacts</strong>
                        <p th:text="${laporan.impact}" th:remove="tag"></p>
                    </p>
                </div>
                <div class="media text-muted pt-3">
                    <p class="media-body pb-3 mb-0 lh-125 border-bottom text-dark">
                        <strong class="d-block text-gray-dark">Description</strong>
                        <p th:text="${laporan.description}" th:remove="tag"></p>
                    </p>
                </div>
                <div class="media text-muted pt-3">
                    <p class="media-body pb-3 mb-0 lh-125 border-bottom text-dark">
                        <strong class="d-block text-gray-dark">Workaround</strong>
                        <ul>
                        	<li th:each="workaround : ${laporan.workarounds}" th:text="${workaround.solution}"></li>
                        </ul>
                    </p>
                </div>
                <div class="media text-muted pt-3">
                    <p class="media-body pb-3 mb-0 lh-125 border-bottom text-dark">
                        <strong class="d-block text-gray-dark">Vendor Status</strong>

                    </p>
                </div>
                <table class="table table-striped border">
                    <thead>
                        <tr class="thead-dark">
                            <th scope="col">Vendor</th>
                            <th scope="col">Status</th>
                            <th scope="col">Update Status</th>
                            <th scope="col">Catatan Vendor</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="statusVendor : ${laporan.statusVendor}">
                            <th scope="row" style="width: 200px;" th:text="${laporan.vendor.name}"></th>
                            <td th:text="${statusVendor.statusVendor}"></td>
                            <td th:text="${#dates.format(statusVendor.createdTimestamp, 'yyyy/MM/dd')}"></td>
                            <td th:text="${statusVendor.catatanVendor}" style="width: 600px;"></td>
                        </tr>
                    </tbody>
                </table>

                <div class="media text-muted pt-3">
                    <p class="media-body pb-3 mb-0 lh-125 border-bottom text-dark">
                    </p>
                </div>

                <div class="media text-muted pt-3">
                    <p class="media-body pb-3 mb-0 lh-125 border-bottom text-dark">
                        <strong class="d-block text-gray-dark">References</strong>
                        <p th:text="${laporan.references}" th:remove="tag"></p>
                    </p>
                </div>
                <div class="media text-muted pt-3">
                    <p class="media-body pb-3 mb-0 lh-125 text-dark">
                        <strong class="d-block text-gray-dark">Vulnerability Analysis - CVSS</strong>
                </div>
                <div class="cvss-wrapper">
                    <div id="cvss-v3-line" class="cvss-line">
                        <span class="cvss-version">CVSS v3</span>
                        <span id="cvss-v3-vector-string"
                            class="cvss-vector-string" th:text="${laporan.vectorString}"></span>
                    </div>
                    <div id="cvssboard"> </div>
                </div>
                <div class="media text-muted pt-3">
                    <p class="media-body pb-3 mb-0 lh-125 border-bottom text-dark">
                        <strong class="d-block text-gray-dark">Credit</strong>
                         <p th:text="${laporan.createdBy.name}" th:remove="tag"></p> melaporkan kerentanan kepada IDVN pada <p th:text="${date}" th:remove="tag">
                    </p>
                </div>
                <!-- End Content Isi -->
            </div>
        </div>
    </div>
    <div th:replace="/fragments/footerFragment :: footer" th:remove="tag"></div>
    <script src="../static/js/cvss.js" th:src="@{/js/cvssView.js}"></script>

    <script>
        var c = new CVSS("cvssboard", );
        c.set(document.getElementById("cvss-v3-vector-string").textContent);
    </script>
    <!-- /container -->
    <!-- Bootstrap core JavaScript
================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../static/js/bootstrap.js" th:src="@{/js/bootstrap.js}"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
</body>

</html>